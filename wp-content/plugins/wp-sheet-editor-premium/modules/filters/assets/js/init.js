jQuery(document).ready(function(){var t=jQuery("#be-filters"),o=t.parents(".remodal");if(!t.length)return!0;o.submit(function(e){e.preventDefault();var n=t.serialize();return t.find("select.select2").each(function(){var e=jQuery(this);e.val()||(n+="&"+e.attr("name")+"=")}),t.find("input:checkbox").each(function(){var e=jQuery(this);if(!e.prop("checked")&&e.attr("name")){var t=e.data("unchecked-value")||"";n+="&"+e.attr("name")+"="+t}}),beAddRowsFilter(n),vgseReloadSpreadsheet(!0,vgse_editor_settings.texts.save_changes_before_remove_filter),o.is(":visible")&&o.find(".remodal-cancel").trigger("click"),!1}),vgseFilters.setLastSessionFilters()}),jQuery(document).ready(function(){jQuery("body").on("vgSheetEditor:beforeRowsInsert",function(e,t){if(void 0===window.cellLocatorAlreadyInit){window.cellLocatorAlreadyInit=!0;var n=document.getElementById("cell-locator-input");n&&Handsontable.dom.addEvent(n,"keyup",function(e){if(13==e.keyCode){var t=hot.getPlugin("search").query(this.value);t.length?hot.scrollViewportTo(t[0].row,t[0].col,!0):this.value&&alert("Cells not found. Try with another search criteria."),hot.render(),jQuery("#responseConsole .rows-located").length||jQuery("#responseConsole").append('. <span class="rows-located" />'),jQuery("#responseConsole .rows-located").text(t.length+" cells located")}})}if(void 0===window.columnLocatorAlreadyInit){window.columnLocatorAlreadyInit=!0;var o=document.getElementById("column-locator-input");o&&Handsontable.dom.addEvent(o,"keyup",function(e){if(13==e.keyCode){var t=this.value;if("number"!=typeof(o=hot.propToCol(t))&&(o=null),"number"!=typeof(o=o||hot.propToCol(t.toLowerCase()))&&(o=null),o)s=1;else{var n=hot.getSettings().colHeaders,o=null,r=this.value.toLowerCase(),s=0;n.forEach(function(e,t){e&&e.indexOf("<input")<0&&-1<e.toLowerCase().indexOf(r)&&(0===s&&(o=t),s++)})}null!==o?hot.selectColumns(o):this.value&&(alert(vgse_editor_settings.texts.column_not_found),vgse_editor_settings.texts.hint_missing_column_on_scroll&&notification({mensaje:vgse_editor_settings.texts.hint_missing_column_on_scroll,tipo:"info",time:4e4,position:"bottom"})),jQuery("#responseConsole .columns-located").length||jQuery("#responseConsole").append('. <span class="columns-located" />'),jQuery("#responseConsole .columns-located").text(s+" columns located")}})}})}),jQuery(document).ready(function(){jQuery("body").on("keyup",".button-container.run_filters-container .toolbar-submenu input",function(e){13==e.keyCode&&vgseFilters.startQuickSearch()}),jQuery("body").on("click",".button-container.run_filters-container .toolbar-submenu .wpse-start-quick-search",function(e){e.preventDefault(),vgseFilters.startQuickSearch()})});var vgseFilters={startQuickSearch:function(){jQuery(".button-container.run_filters-container .toolbar-submenu").find("input,select,textarea").each(function(){var e=jQuery(this).attr("name");if(e){var t=jQuery(this).val(),n=jQuery("#be-filters").find("input,select,textarea").filter(function(){return jQuery(this).attr("name")===e});"checkbox"===n.attr("type")?n.prop("checked",jQuery(this).prop("checked")):n.val(t),n.trigger("change")}}),jQuery("#be-filters").submit()},setLastSessionFilters:function(){vgse_editor_settings.last_session_filters&&(beAddRowsFilter(vgse_editor_settings.last_session_filters),this.fillSearchForm(vgse_editor_settings.last_session_filters),vgseCustomTooltip(jQuery(".vgse-current-filters a").last(),vgse_editor_settings.texts.last_session_filters_notice,"right"))},setFiltersSilently:function(e){e&&beAddRowsFilter(e)},fillSearchForm:function(e){var o=jQuery("#be-filters"),t="string"==typeof e?beParseParams(e):e;jQuery.each(t,function(e,t){if(e){var n=o.find("input,select,textarea").filter(function(){return jQuery(this).attr("name")===e});"checkbox"===n.attr("type")?n.prop("checked",t):n.val(t),n.trigger("change")}})}};